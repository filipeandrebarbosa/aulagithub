âœ… 1) Feature File (BDD)

ðŸ“Œ Include/features/Smoke/UserAccess/Login.feature

Feature: User Login


  As a user of the system
  I want to login with valid or invalid credentials
  So that authentication is validated correctly




  @smoke @login
  Scenario Outline: Login validation with different credentials


    Given the user opens the browser
    And the user navigates to the login page


    When the user logs in as "<role>" using "<sheet>"


    Then the login result should be "<expectedResult>"




    Examples:
      | role        | sheet               | expectedResult |
      | Admin       | ValidCredentials    | success        |
      | Admin       | InvalidCredentials  | error          |
      | Approver 1  | ValidCredentials    | success        |
      | Approver 1  | InvalidCredentials  | error          |
âœ… 2) Step Definitions

ðŸ“Œ Scripts/stepDefinitions/UserAccess/LoginSteps.groovy

package stepDefinitions.UserAccess


import com.kms.katalon.core.webui.keyword.WebUiBuiltInKeywords as WebUI


import cucumber.api.java.en.Given
import cucumber.api.java.en.When
import cucumber.api.java.en.Then


import Pages.UserAccess.LoginPage




class LoginSteps {


    LoginPage loginPage = new LoginPage()




    // -----------------------------
    // GIVEN
    // -----------------------------


    @Given("the user opens the browser")
    def openBrowser() {
        WebUI.openBrowser("")
        WebUI.maximizeWindow()
    }


    @Given("the user navigates to the login page")
    def navigateToLoginPage() {
        loginPage.goToLoginPage()
    }




    // -----------------------------
    // WHEN
    // -----------------------------


    @When("the user logs in as {string} using {string}")
    def loginAsRoleFromSheet(String role, String sheet) {
        loginPage.loginWithRole(role, sheet)
    }




    // -----------------------------
    // THEN
    // -----------------------------


    @Then("the login result should be {string}")
    def verifyLoginResult(String expectedResult) {


        if (expectedResult.equalsIgnoreCase("success")) {
            loginPage.verifyLoginSuccess()
        }
        else if (expectedResult.equalsIgnoreCase("error")) {
            loginPage.verifyLoginFailed()
        }
        else {
            throw new Exception("Unknown expected result: " + expectedResult)
        }


        WebUI.closeBrowser()
    }
}
âœ… 3) BasePage (Core POM)

ðŸ“Œ Keywords/Pages/Common/BasePage.groovy

package Pages.Common


import com.kms.katalon.core.webui.keyword.WebUiBuiltInKeywords as WebUI
import com.kms.katalon.core.model.FailureHandling




class BasePage {


    def waitForElement(def testObject, int timeout = 10) {
        WebUI.waitForElementVisible(testObject, timeout, FailureHandling.STOP_ON_FAILURE)
    }


    def click(def testObject) {
        waitForElement(testObject)
        WebUI.click(testObject)
    }


    def type(def testObject, String text) {
        waitForElement(testObject)
        WebUI.setText(testObject, text)
    }


    def verifyElementPresent(def testObject) {
        WebUI.verifyElementPresent(testObject, 10, FailureHandling.STOP_ON_FAILURE)
    }
}
âœ… 4) Login Page Object (Excel Driven Login)

ðŸ“Œ Keywords/Pages/UserAccess/LoginPage.groovy

package Pages.UserAccess


import static com.kms.katalon.core.testobject.ObjectRepository.findTestObject
import static com.kms.katalon.core.testdata.TestDataFactory.findTestData


import com.kms.katalon.core.webui.keyword.WebUiBuiltInKeywords as WebUI
import com.kms.katalon.core.testdata.TestData


import internal.GlobalVariable


import Pages.Common.BasePage




class LoginPage extends BasePage {


    // -----------------------------
    // Object Repository locators
    // -----------------------------
    def usernameField = findTestObject("Pages/UserAccess/Login/input_username")
    def passwordField = findTestObject("Pages/UserAccess/Login/input_password")
    def signInButton  = findTestObject("Pages/UserAccess/Login/btn_signIn")


    def dashboardElement = findTestObject("Pages/UserAccess/Login/dashboard_home")


    // Error message object (must exist)
    def errorMessage = findTestObject("Pages/UserAccess/Login/msg_error")




    // -----------------------------
    // Navigation
    // -----------------------------
    def goToLoginPage() {
        WebUI.navigateToUrl(GlobalVariable.baseUrl + "/login")
    }




    // -----------------------------
    // Excel Role Login
    // -----------------------------
    def loginWithRole(String role, String sheetName) {


        TestData data = findTestData("LoginUsers")
        data.changeSheet(sheetName)


        for (int i = 1; i <= data.getRowNumbers(); i++) {


            String excelRole = data.getValue("role", i)


            if (excelRole != null && excelRole.equalsIgnoreCase(role)) {


                String username = data.getValue("user", i)
                String password = data.getValue("password", i)


                println("Logging in as: " + role + " (" + username + ") from sheet: " + sheetName)


                type(usernameField, username)
                type(passwordField, password)
                click(signInButton)


                return
            }
        }


        throw new Exception("Role not found in Excel: " + role + " (Sheet: " + sheetName + ")")
    }




    // -----------------------------
    // Validations
    // -----------------------------
    def verifyLoginSuccess() {
        verifyElementPresent(dashboardElement)
    }


    def verifyLoginFailed() {
        verifyElementPresent(errorMessage)
    }
}
âœ… 5) Object Repository obrigatÃ³rio

Confirma que tens estes objects:

Object Repository/Pages/UserAccess/Login/
   input_username
   input_password
   btn_signIn
   dashboard_home
   msg_error   <-- tens de criar este
âœ… 6) Criar o objecto msg_error

ðŸ“Œ msg_error

XPath tÃ­pico (ajusta ao teu sistema):

//div[contains(@class,'error')]

ou se tiver texto:

//*[contains(text(),'Invalid')]
âœ… 7) Execution Profile

ðŸ“Œ Profiles/QA.glbl

SÃ³ precisa disto:

Name	Value
baseUrl	https://harmoni-qa
...

Users vÃªm todos do Excel.
