A tua sheet ValidCredentials tem exatamente o formato ideal:

âœ… colunas:

userName

user

password

role

E tens roles tipo:

PR Requester

Approver 1

Business Support

Admin
etcâ€¦

Ou seja: isto Ã© ouro para automation enterprise.

Agora vamos sÃ³ ligar isto ao teu login.

âœ… Objetivo final

Tu queres escrever na feature:

When the user logs in as "Admin"

E o sistema vai buscar automaticamente:

username/email

password

no Excel, na sheet certa.

âœ… PASSO 1 â€” Importar o Excel no Katalon

JÃ¡ tens o ficheiro Excel.

Agora no Katalon:

Data Files â†’ botÃ£o direito â†’ New â†’ Test Data

Escolhe:

âœ… Excel File

Nome:

LoginUsers

Seleciona o ficheiro.

ğŸ“Œ Vai aparecer assim:

Data Files/LoginUsers
âœ… PASSO 2 â€” CÃ³digo correto no LoginPage.groovy

Agora mete isto no teu:

ğŸ“Œ Keywords/Pages/UserAccess/LoginPage.groovy

package Pages.UserAccess


import static com.kms.katalon.core.testobject.ObjectRepository.findTestObject
import com.kms.katalon.core.testdata.TestData
import static com.kms.katalon.core.testdata.TestDataFactory.findTestData


import Pages.Common.BasePage


class LoginPage extends BasePage {


    def usernameField = findTestObject("Pages/UserAccess/Login/input_username")
    def passwordField = findTestObject("Pages/UserAccess/Login/input_password")
    def signInButton  = findTestObject("Pages/UserAccess/Login/btn_signIn")


    def dashboardElement = findTestObject("Pages/UserAccess/Login/dashboard_home")


    // --- LOGIN WITH EXCEL ROLE ---
    def loginWithRole(String role, String sheetName = "ValidCredentials") {


        TestData data = findTestData("LoginUsers")
        data.changeSheet(sheetName)


        for (int i = 1; i <= data.getRowNumbers(); i++) {


            String excelRole = data.getValue("role", i)


            if (excelRole != null && excelRole.equalsIgnoreCase(role)) {


                String username = data.getValue("user", i)
                String password = data.getValue("password", i)


                println("Logging in as role: " + role + " -> " + username)


                type(usernameField, username)
                type(passwordField, password)
                click(signInButton)


                return
            }
        }


        throw new Exception("Role not found in Excel sheet: " + role)
    }


    def verifyLoginSuccess() {
        verifyElementPresent(dashboardElement)
    }
}
âœ… PASSO 3 â€” Step Definition em LoginSteps.groovy

Agora no teu:

ğŸ“Œ Scripts/stepDefinitions/UserAccess/LoginSteps.groovy

Adiciona:

@When("the user logs in as {string}")
def loginAsRole(String role) {
    loginPage.loginWithRole(role, "ValidCredentials")
}
âœ… PASSO 4 â€” Feature file

ğŸ“Œ Login.feature

Agora podes escrever:

Scenario: Login as Admin
  Given the user opens the browser
  And the user navigates to the login page
  When the user logs in as "Admin"
  Then the user should be logged in successfully

ğŸ”¥ Ele vai procurar no Excel a linha onde role = Admin.

âš ï¸ AtenÃ§Ã£o MUITO importante

No teu Excel o role parece ser:

Admin
PR Requester
Approver 1
Approver 2
P2P Specialist
...

EntÃ£o tens de usar exatamente o mesmo texto.

Exemplo:

When the user logs in as "Approver 1"
âœ… PASSO 5 â€” CenÃ¡rios invÃ¡lidos (sheet InvalidCredentials)

Para login negativo:

Scenario: Login fails
  When the user logs in as "Admin" from "InvalidCredentials"
  Then error message should appear

Step:

@When("the user logs in as {string} from {string}")
def loginFromSheet(String role, String sheet) {
    loginPage.loginWithRole(role, sheet)
}

Agora podes usar qualquer sheet:

ValidCredentials

InvalidCredentials

loginExtranet

ğŸ† Melhor prÃ¡tica enterprise para ti

Eu recomendo:

Feature usa sempre ROLE
When user logs in as "Approver 2"

Nunca username direto.

Porque username muda, role nÃ£o.

ğŸš€ PrÃ³ximo passo

Filipe, queres que eu te faÃ§a jÃ¡ o Step universal:

âœ… Given the user is logged in as "Approver 1"

Para poderes comeÃ§ar todas as features assim:

Given the user is logged in as "Admin"
When user creates purchase order
Then it should be approved

Isso Ã© mesmo nÃ­vel banco/enterprise ğŸ˜„
